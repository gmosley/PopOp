<!DOCTYPE html>
<html>

<head>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon-32x32.png') }}" sizes="32x32">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon-96x96.png') }}" sizes="96x96">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon-16x16.png') }}" sizes="16x16">
  <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">

  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76615811-1', 'auto');
  ga('send', 'pageview');

</script>

  <title>Vote</title>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <!-- jQueryUI -->
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <link rel="stylesheet" type="text/css" href="../static/vote.css">
  <link rel="stylesheet" type="text/css" href="../static/footer-basic-centered.css">

  <title>Vote</title>
  <script type="text/javascript">
    var img1 = "{{ img_1 }}";
    var img2 = "{{ img_2 }}";
    var img3 = "{{ img_3 }}";
    var addresses = [img1, img2, img3];
    var description = "{{ description }}";

    var list = []
    var onload = function() {
      $('#descrip').html(description);

      $('#1').html(generateImg(img1));
      $('#2').html(generateImg(img2));
      $('#3').html(generateImg(img3));

      $('#1').click(function() {
        console.log("1 clicked");
        clickedImage(1);
      });

      $('#2').click(function() {
        console.log("2 clicked");
        clickedImage(2)
      });

      $('#3').click(function() {
        console.log("3 clicked");
        clickedImage(3)
      });

      $('#submit_form').submit(function() {
        calcList();
        ret = submit();
        return ret;
      });
    }

    var generateImg = function(img) {
      return '<img class="fill" src="' + img + '">';
    }

    var clickedImage = function(num) {
      if (list.length <= 0) {
        $('#prompt').attr('hidden', true);
      }
      if (list.indexOf(num) < 0) {
        list.push(num);
        html = '<li class="ui-state-default" id=sort' + num + '>';
        html += $('#' + num).html() + '</li>';
        $('#sortable').append(html);
        // set remove function
        $('#sort' + num).dblclick(function() {
          removeItem(num);
        });
        $( '#sortable' ).sortable();
        $( '#sortable' ).disableSelection();
      }
    }

    var calcList = function() {
      list = []
      console.log($('#sortable').children());
      $('#sortable').children('li').each(function() {
        id = $( this ).attr('id')
        if (id) {
          id = id.replace(/\D/g,'');
          list.push(parseInt(id))
        }
      });
    }

    var removeItem = function(num) {
      if (list.indexOf(num) >= 0) {
        list.splice(list.indexOf(num),1);
        $('#sort' + num).remove();
        if (list.length <= 0) {
          $('#prompt').attr('hidden', false);
        }
      }
    }

    var submit = function() {
      console.log('submit');
      calcList();
      if (list.length < 3) {
        alert = '<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Please rank all the items!</strong></div>';
        $('#error_div').html(alert);
        console.log('dont submit');
        return false;
      }
      $('#first_input').val(addresses[list[0] - 1]);
      $('#second_input').val(addresses[list[1] - 1]);
      $('#third_input').val(addresses[list[2] - 1]);
      return true;
    }

    document.onload = function() {
      onload();
    }

  </script>
</head>

<body>
<nav class="navbar navbar-inverse" style='border-radius: 0px;'>
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">PopOp</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="active"><a href="/">Home</a></li>
        <li class="active"><a href="/upload">Request</a></li>
        <li class="active"><a href="/vote">Vote</a></li>
      </ul>
      <form class="navbar-form navbar-right">
        <div class="form-group">
          <input type="text" placeholder="Email" class="form-control">
        </div>
        <div class="form-group">
          <input type="password" placeholder="Password" class="form-control">
        </div>
        <button type="submit" class="btn btn-success" disabled=true>Sign in</button>
      </form>
    </div><!--/.navbar-collapse -->
  </div>
</nav>

<div class="container-fluid main">
  <h1>Work</h1>
  <h3 id="descrip"></h3>
  <div class="col-md-12 well interact">
    <div class="col-md-1">
      <h3>Best</h3>
    </div>
    <div class="col-md-10">
      <h3 id=prompt>Click the images below to rank them from best to not so best, and double-click to remove them. You can also drag them around if you change your mind!</h3>
      <ul id="sortable"></ul>
    </div>
    <div class="col-md-1">
      <h3>Worst</h3>
    </div>
<!--       <form action="/report" method="POST">  
        <input type="radio" name="report" value="nudity"> Nudity<br>
        <input type="radio" name="report" value="offensive"> Offensive<br>
        <input type="radio" name="report" value="other"> No images
      </form> -->
  </div>
  <br/>
  <div class="col-md-12 well interact">
    <ul id="selectable">
      <li class="ui-state-default" id=1></li>
      <li class="ui-state-default" id=2></li>
      <li class="ui-state-default" id=3></li>
    </ul>
  </div>
  <div class="col-md-12" id="error_div"></div>
  <form method='post' id="submit_form">
    <input id='first_input' name='first' hidden="true"></input>
    <input id='second_input' name='second' hidden="true"></input>
    <input id='third_input' name='third' hidden="true"></input>
    <button type="submit" class="btn btn-primary btn-lg" style="float: right;">Submit</button>
  </form>
</div>

<footer class="footer-basic-centered">
  <p class="footer-company-motto">Get PopOppin'</p>
  <p style="font-weight: lighter; color: #777; margin-bottom: -15px;">None of these work...</p>
  <p class="footer-links">
    <a href="#">Home</a>
    路
    <a href="#">Blog</a>
    路
    <a href="#">About</a>
    路
    <a href="#">Faq</a>
    路
    <a href="#">Contact</a>
  </p>
  <p class="footer-company-name">PopOp &copy; 2016</p>
</footer>

</body>

</html>